# ğŸš€ Terraform Infrastructure Collection

**æœ€æ–°ã®æ›´æ–°**: 2024å¹´12æœˆ - å®Œå…¨å‹•ä½œç¢ºèªæ¸ˆã¿

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã€AWSç’°å¢ƒã§ã‚ˆãä½¿ç”¨ã•ã‚Œã‚‹Terraformãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¨ãƒ„ãƒ¼ãƒ«ã‚’æä¾›ã™ã‚‹åŒ…æ‹¬çš„ãªã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ç®¡ç†ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚

## âœ¨ æœ€æ–°ã®ç‰¹å¾´

### ğŸ”„ **2024å¹´12æœˆã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ**
- âœ… **Terraform 1.0+ å¯¾å¿œ** - æœ€æ–°ã®æ§‹æ–‡ã¨ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼
- âœ… **AWS Provider 5.x å¯¾å¿œ** - æœ€æ–°æ©Ÿèƒ½ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
- âœ… **å…¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å‹•ä½œç¢ºèªæ¸ˆã¿** - `terraform plan` æ¤œè¨¼æ¸ˆã¿
- âœ… **çµ±åˆã‚¿ã‚°æˆ¦ç•¥** - ä¸€è²«ã—ãŸãƒªã‚½ãƒ¼ã‚¹ç®¡ç†ã¨ã‚³ã‚¹ãƒˆè¿½è·¡
- âœ… **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–** - æœ€å°æ¨©é™åŸå‰‡ã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹
- âœ… **è‡ªå‹•åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ** - ç¢ºèªä»˜ããƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ
- âœ… **åŒ…æ‹¬çš„ç›£è¦–** - CloudWatchã€SNSã€è©³ç´°ãƒ­ã‚°åˆ†æ

## ğŸ—ï¸ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¦‚è¦

```
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚                 AWS Infrastructure                      â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                     â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚                               â”‚                               â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   Load Balancer   â”‚          â”‚   ECS Cluster     â”‚          â”‚   Auto Scaling    â”‚
            â”‚                   â”‚          â”‚                   â”‚          â”‚                   â”‚
            â”‚ â”œâ”€ ALB/NLB        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”œâ”€ Services       â”‚          â”‚ â”œâ”€ Launch Template â”‚
            â”‚ â”œâ”€ Target Groups  â”‚          â”‚ â”œâ”€ Tasks          â”‚          â”‚ â”œâ”€ Scaling Policiesâ”‚
            â”‚ â””â”€ SSL/TLS        â”‚          â”‚ â””â”€ Container Mgmt â”‚          â”‚ â””â”€ Health Checks  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚                               â”‚                               â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                     â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚                               â”‚                               â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚   Monitoring      â”‚          â”‚   Container Reg   â”‚          â”‚   Data Analytics  â”‚
            â”‚                   â”‚          â”‚                   â”‚          â”‚                   â”‚
            â”‚ â”œâ”€ CloudWatch     â”‚          â”‚ â”œâ”€ ECR Repository â”‚          â”‚ â”œâ”€ Athena         â”‚
            â”‚ â”œâ”€ SNS Alarms     â”‚          â”‚ â”œâ”€ Image Scanning â”‚          â”‚ â”œâ”€ Glue Crawler   â”‚
            â”‚ â””â”€ Log Analytics  â”‚          â”‚ â””â”€ Lifecycle Mgmt â”‚          â”‚ â””â”€ S3 Integration â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ ä¸»è¦ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«

### ğŸ–¥ï¸ **EC2 Auto Scaling Group**
**å ´æ‰€**: [`ec2/auto_scaling_group/`](./ec2/auto_scaling_group/)

**2024å¹´12æœˆæ–°æ©Ÿèƒ½:**
- ğŸ”„ **ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥** - ã‚¼ãƒ­ãƒ€ã‚¦ãƒ³ã‚¿ã‚¤ãƒ ãƒ­ãƒ¼ãƒªãƒ³ã‚°æ›´æ–°
- ğŸ“Š **é«˜åº¦ãªã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°** - ã‚¿ãƒ¼ã‚²ãƒƒãƒˆè¿½è·¡ãƒ»ã‚¹ãƒ†ãƒƒãƒ—ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°
- ğŸ·ï¸ **çµ±åˆã‚¿ã‚°æˆ¦ç•¥** - ç’°å¢ƒãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»é‹ç”¨ã‚¿ã‚°è‡ªå‹•é©ç”¨
- ğŸ“‰ **å®Œå…¨ã‚³ã‚¹ãƒˆæœ€é©åŒ–** - 0å°ã‚¹ã‚±ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³å¯¾å¿œ
- ğŸ”” **åŒ…æ‹¬çš„ã‚¢ãƒ©ãƒ¼ãƒ ** - 4ç¨®é¡ã®CloudWatchã‚¢ãƒ©ãƒ¼ãƒ  + SNSé€šçŸ¥
- ğŸ” **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–** - KMSæš—å·åŒ–ã€å…¥åŠ›ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
- ğŸ§ª **è‡ªå‹•ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ** - ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯æ¤œè¨¼

### ğŸš€ **EC2 Launch Template**
**å ´æ‰€**: [`ec2/launch_template/`](./ec2/launch_template/)

**ç‰¹å¾´:**
- ğŸ§ **Amazon Linux 2023 ECSæœ€é©åŒ–** - æœ€æ–°ã®AMIè‡ªå‹•é¸æŠ
- ğŸ“Š **çµ±åˆç›£è¦–** - CloudWatch Agent + Mackerel Agent
- ğŸ”’ **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–** - IMDSv2å¼·åˆ¶ã€EBSæš—å·åŒ–
- ğŸ› ï¸ **è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«** - ctopã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ„ãƒ¼ãƒ«è‡ªå‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- ğŸ¯ **ECSçµ±åˆ** - ã‚³ãƒ³ãƒ†ãƒŠå®Ÿè¡Œç’°å¢ƒã®æœ€é©åŒ–

### ğŸ³ **ECR Repository**
**å ´æ‰€**: [`ecr/repository/`](./ecr/repository/)

**æ©Ÿèƒ½:**
- ğŸ“¦ **å˜ä¸€ãƒ»è¤‡æ•°ãƒªãƒã‚¸ãƒˆãƒª** - æŸ”è»Ÿãªæ§‹æˆå¯¾å¿œ
- ğŸ”„ **ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒãƒªã‚·ãƒ¼** - è‡ªå‹•ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
- ğŸ” **ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚¹ã‚­ãƒ£ãƒ³** - è„†å¼±æ€§æ¤œå‡ºã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç¢ºèª
- ğŸ” **æš—å·åŒ–è¨­å®š** - AES256/KMSæš—å·åŒ–å¯¾å¿œ
- ğŸŒ **ã‚¯ãƒ­ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ** - è¤‡æ•°ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé–“ã§ã®ã‚¤ãƒ¡ãƒ¼ã‚¸å…±æœ‰

### ğŸ”§ **ECS Cluster**
**å ´æ‰€**: [`ecs/cluster/`](./ecs/cluster/)

**æ©Ÿèƒ½:**
- ğŸš€ **Fargate & EC2çµ±åˆ** - è¤‡æ•°ã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¿ã‚¤ãƒ—
- ğŸ“Š **Container Insights** - è©³ç´°ãªã‚³ãƒ³ãƒ†ãƒŠãƒ¡ãƒˆãƒªã‚¯ã‚¹
- ğŸ”§ **Execute Command** - ã‚³ãƒ³ãƒ†ãƒŠã¸ã®å®‰å…¨ãªã‚¢ã‚¯ã‚»ã‚¹
- âš–ï¸ **ã‚­ãƒ£ãƒ‘ã‚·ãƒ†ã‚£ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼** - ã‚³ã‚¹ãƒˆæœ€é©åŒ–ã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

### ğŸŒ **ECS Service**
**å ´æ‰€**: [`ecs/service/`](./ecs/service/)

**æ©Ÿèƒ½:**
- ğŸ”„ **ã‚¿ã‚¹ã‚¯å®šç¾©ç®¡ç†** - å®Œå…¨ãªã‚³ãƒ³ãƒ†ãƒŠãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«
- ğŸ” **IAMçµ±åˆ** - è‡ªå‹•çš„ãªãƒ­ãƒ¼ãƒ«ãƒ»ãƒãƒªã‚·ãƒ¼ä½œæˆ
- ğŸ“ˆ **Auto Scaling** - CPU/ãƒ¡ãƒ¢ãƒªãƒ™ãƒ¼ã‚¹ã®è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°
- ğŸ”— **ãƒ­ãƒ¼ãƒ‰ãƒãƒ©ãƒ³ã‚µãƒ¼çµ±åˆ** - ALB/NLBå®Œå…¨çµ±åˆ

### âš–ï¸ **Application Load Balancer**
**å ´æ‰€**: [`load_balancer/alb/`](./load_balancer/alb/)

**æ©Ÿèƒ½:**
- ğŸ” **SSL/TLSçµ‚ç«¯** - è‡ªå‹•HTTPSãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
- ğŸ¯ **ECSçµ±åˆ** - IPãƒ™ãƒ¼ã‚¹ã‚¿ãƒ¼ã‚²ãƒƒãƒˆç¾¤å¯¾å¿œ
- ğŸ” **ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯** - æœ€é©åŒ–ã•ã‚ŒãŸECSç”¨è¨­å®š
- ğŸ“Š **é«˜å¯ç”¨æ€§** - è¤‡æ•°AZè‡ªå‹•åˆ†æ•£

### ğŸ“Š **Athena Analytics**
**å ´æ‰€**: [`analytics/athena/`](./analytics/athena/)

**æ©Ÿèƒ½:**
- ğŸ” **è¤‡æ•°ãƒ­ã‚°ã‚¿ã‚¤ãƒ—åˆ†æ** - Djangoã€Nginxã€Errorãƒ­ã‚°å¯¾å¿œ
- ğŸš€ **ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³å°„å½±** - é«˜é€Ÿã‚¯ã‚¨ãƒªå®Ÿè¡Œ
- ğŸ”„ **Glue Crawlerè‡ªå‹•åŒ–** - ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«å®Ÿè¡Œã«ã‚ˆã‚‹è‡ªå‹•ã‚¹ã‚­ãƒ¼ãƒæ›´æ–°
- ğŸ“‹ **äº‹å‰å®šç¾©ã‚¯ã‚¨ãƒª** - å³åº§ã«ä½¿ç”¨å¯èƒ½ãªã‚¯ã‚¨ãƒªãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

## ğŸš€ ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

### 1. ğŸ“‹ å‰ææ¡ä»¶ç¢ºèª

```bash
# å¿…è¦ãªãƒ„ãƒ¼ãƒ«ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª
terraform version  # >= 1.0
aws --version      # AWS CLI v2æ¨å¥¨
jq --version       # JSONãƒ—ãƒ­ã‚»ãƒƒã‚µãƒ¼
```

### 2. ğŸ”‘ AWSè¨­å®š

```bash
# èªè¨¼æƒ…å ±è¨­å®š
aws configure

# ç¾åœ¨ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç¢ºèª
aws sts get-caller-identity

# å¿…è¦ãªæ¨©é™ç¢ºèª
aws iam list-attached-user-policies --user-name $(aws sts get-caller-identity --query User.UserName --output text)
```

### 3. ğŸ› ï¸ åŸºæœ¬ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¯ãƒ­ãƒ¼ãƒ³
git clone <repository-url>
cd terraform

# è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«æº–å‚™
cp terraform.tfvars.example terraform.tfvars
vi terraform.tfvars  # ç’°å¢ƒã«å¿œã˜ã¦ç·¨é›†

# åŸºæœ¬è¨­å®šä¾‹
cat > terraform.tfvars << EOF
# åŸºæœ¬è¨­å®š
project_name = "myproject"
environment  = "dev"
app          = "web"

# AWSè¨­å®š
aws_region = "ap-northeast-1"

# å…±é€šã‚¿ã‚°
common_tags = {
  Project     = "myproject"
  Environment = "dev"
  Owner       = "team-name"
  ManagedBy   = "terraform"
}
EOF
```

### 4. ğŸš€ ç¢ºèªä»˜ããƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆï¼ˆæ¨å¥¨ï¼‰

```bash
# ç¢ºèªä»˜ããƒ—ãƒ©ãƒ³å®Ÿè¡Œ
./plan_with_confirmation.sh

# ç¢ºèªä»˜ããƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ
./apply_with_confirmation.sh

# ãƒªã‚½ãƒ¼ã‚¹çŠ¶æ…‹ç¢ºèª
terraform state list
```

## ğŸ”§ è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«

### ğŸ“‹ ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ

| ã‚¹ã‚¯ãƒªãƒ—ãƒˆ                      | èª¬æ˜                      | ä½¿ç”¨å ´é¢               |
| ------------------------------- | ------------------------- | ---------------------- |
| `plan_with_confirmation.sh`     | AWSç¢ºèªä»˜ããƒ—ãƒ©ãƒ³å®Ÿè¡Œ     | å¤‰æ›´å†…å®¹ã®äº‹å‰ç¢ºèª     |
| `apply_with_confirmation.sh`    | AWSç¢ºèªä»˜ããƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ | å®‰å…¨ãªæœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤     |
| `search_terraform_resources.sh` | ãƒªã‚½ãƒ¼ã‚¹æ¤œç´¢ãƒ»é›†è¨ˆ        | ç¾åœ¨ã®ãƒªã‚½ãƒ¼ã‚¹çŠ¶æ³ç¢ºèª |

### ğŸ” ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†

```bash
# ãƒªã‚½ãƒ¼ã‚¹æ¤œç´¢
./search_terraform_resources.sh

# ç‰¹å®šã®ãƒªã‚½ãƒ¼ã‚¹ã‚¿ã‚¤ãƒ—æ¤œç´¢
./search_terraform_resources.sh aws_instance

# AWSã‚¢ã‚«ã‚¦ãƒ³ãƒˆç¢ºèª
./analytics/check_aws_account.sh
```

## ğŸ“Š è¨­å®šç®¡ç†

### ğŸ¯ åŸºæœ¬è¨­å®šãƒ‘ã‚¿ãƒ¼ãƒ³

```hcl
# é–‹ç™ºç’°å¢ƒ
project_name = "myproject"
environment  = "dev"
app          = "web"

# æœ¬ç•ªç’°å¢ƒ
project_name = "myproject"
environment  = "prod"
app          = "api"

# å…±é€šã‚¿ã‚°æˆ¦ç•¥
common_tags = {
  Project     = var.project_name
  Environment = var.environment
  Owner       = "team-name"
  ManagedBy   = "terraform"
  CostCenter  = "engineering"
  Schedule    = "business-hours"
}
```

### ğŸ·ï¸ ã‚¿ã‚°æˆ¦ç•¥

**å¿…é ˆã‚¿ã‚°ï¼ˆè‡ªå‹•é©ç”¨ï¼‰:**
- `Project` - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè­˜åˆ¥å­
- `Environment` - ç’°å¢ƒè­˜åˆ¥å­ï¼ˆdev/stg/prodï¼‰
- `ManagedBy` - ç®¡ç†æ–¹æ³•ï¼ˆterraformï¼‰

**æ¨å¥¨ã‚¿ã‚°:**
- `Owner` - è²¬ä»»è€…ãƒ»ãƒãƒ¼ãƒ å
- `CostCenter` - ã‚³ã‚¹ãƒˆã‚»ãƒ³ã‚¿ãƒ¼
- `Schedule` - ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆé‹ç”¨æ™‚é–“ï¼‰
- `BackupRequired` - ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—è¦å¦

è©³ç´°ã¯[TERRAFORM-TAGS-STRATEGY.md](./TERRAFORM-TAGS-STRATEGY.md)å‚ç…§

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### ğŸ”’ IAMæ¨©é™ç®¡ç†

```hcl
# æœ€å°æ¨©é™åŸå‰‡
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "ec2:Describe*",
        "ecs:Describe*",
        "elasticloadbalancing:Describe*"
      ],
      "Resource": "*"
    }
  ]
}
```

### ğŸ” æš—å·åŒ–è¨­å®š

**ä¿å­˜æ™‚æš—å·åŒ–:**
- EBS: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§AES256æš—å·åŒ–
- S3: SSE-S3ã¾ãŸã¯SSE-KMS
- RDS: TDEï¼ˆé€éçš„ãƒ‡ãƒ¼ã‚¿æš—å·åŒ–ï¼‰

**è»¢é€æ™‚æš—å·åŒ–:**
- ALB: HTTPSå¼·åˆ¶ã€HTTPâ†’HTTPSãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
- ECS: Service Connect TLS
- ECR: ãƒ—ãƒƒã‚·ãƒ¥/ãƒ—ãƒ«æ™‚TLS

### ğŸ”‘ ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆç®¡ç†

```hcl
# Parameter Storeä½¿ç”¨ä¾‹
resource "aws_ssm_parameter" "db_password" {
  name  = "/${var.project_name}/${var.environment}/database/password"
  type  = "SecureString"
  value = var.db_password

  tags = local.common_tags
}

# ECSã‚¿ã‚¹ã‚¯ã§ã®ä½¿ç”¨
container_definitions = jsonencode([
  {
    name = "app"
    secrets = [
      {
        name      = "DB_PASSWORD"
        valueFrom = aws_ssm_parameter.db_password.arn
      }
    ]
  }
])
```

## ğŸ“ˆ é‹ç”¨ãƒ»ç›£è¦–

### ğŸ”” ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š

```hcl
# CloudWatch ã‚¢ãƒ©ãƒ¼ãƒ ä¾‹
resource "aws_cloudwatch_metric_alarm" "high_cpu" {
  alarm_name          = "${var.project_name}-${var.environment}-high-cpu"
  comparison_operator = "GreaterThanThreshold"
  evaluation_periods  = "2"
  metric_name         = "CPUUtilization"
  namespace           = "AWS/ECS"
  period              = "300"
  statistic           = "Average"
  threshold           = "80"
  alarm_description   = "This metric monitors ecs cpu utilization"

  alarm_actions = [aws_sns_topic.alerts.arn]

  dimensions = {
    ServiceName = aws_ecs_service.main.name
    ClusterName = aws_ecs_cluster.main.name
  }
}
```

### ğŸ“Š ã‚³ã‚¹ãƒˆæœ€é©åŒ–

**ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°æˆ¦ç•¥:**
- é–‹ç™ºç’°å¢ƒ: 0å°ã‚¹ã‚±ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³å¯¾å¿œ
- æœ¬ç•ªç’°å¢ƒ: æœ€å°2å°ã§é«˜å¯ç”¨æ€§ç¢ºä¿
- Spot ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹: é–‹ç™ºãƒ»ãƒ†ã‚¹ãƒˆç’°å¢ƒã§70%ã‚³ã‚¹ãƒˆå‰Šæ¸›

**ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†:**
- æœªä½¿ç”¨ãƒªã‚½ãƒ¼ã‚¹ã®è‡ªå‹•å‰Šé™¤
- ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒãƒªã‚·ãƒ¼ã«ã‚ˆã‚‹ãƒ­ã‚°ãƒ»ã‚¤ãƒ¡ãƒ¼ã‚¸ç®¡ç†
- å¤œé–“ãƒ»é€±æœ«ã®è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒ«ãƒ€ã‚¦ãƒ³

## ğŸ”§ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ğŸ“‹ ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

| å•é¡Œ                    | åŸå›              | è§£æ±ºæ–¹æ³•                   |
| ----------------------- | ---------------- | -------------------------- |
| `terraform plan` ã‚¨ãƒ©ãƒ¼ | AWSèªè¨¼æƒ…å ±ä¸æ­£  | `aws configure` ã§å†è¨­å®š   |
| ãƒªã‚½ãƒ¼ã‚¹ä½œæˆå¤±æ•—        | æ¨©é™ä¸è¶³         | IAMãƒãƒªã‚·ãƒ¼ç¢ºèªãƒ»è¿½åŠ       |
| ECS ã‚¿ã‚¹ã‚¯èµ·å‹•å¤±æ•—      | ãƒªã‚½ãƒ¼ã‚¹ä¸è¶³     | CPU/ãƒ¡ãƒ¢ãƒªè¨­å®šè¦‹ç›´ã—       |
| ALB ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯å¤±æ•—  | ãƒãƒ¼ãƒˆè¨­å®šé–“é•ã„ | ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚°ãƒ«ãƒ¼ãƒ—è¨­å®šç¢ºèª |

### ğŸ” ãƒ‡ãƒãƒƒã‚°æ‰‹é †

```bash
# 1. åŸºæœ¬æƒ…å ±ç¢ºèª
terraform version
aws sts get-caller-identity

# 2. çŠ¶æ…‹ç¢ºèª
terraform state list
terraform state show <resource_name>

# 3. ãƒ­ã‚°ç¢ºèª
terraform apply -auto-approve -refresh=true
aws logs describe-log-groups --log-group-name-prefix /aws/ecs/

# 4. ãƒªã‚½ãƒ¼ã‚¹çŠ¶æ³ç¢ºèª
aws ecs describe-services --cluster <cluster_name> --services <service_name>
aws application-autoscaling describe-scaling-policies
```

## ğŸ¯ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

### ğŸ“Š æ¨å¥¨è¨­å®š

| ç’°å¢ƒ         | ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚¿ã‚¤ãƒ— | æœ€å°/æœ€å¤§å°æ•° | CPU/ãƒ¡ãƒ¢ãƒª |
| ------------ | ------------------ | ------------- | ---------- |
| é–‹ç™º         | t3.micro           | 0/4           | 256/512    |
| ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚° | t3.small           | 1/8           | 512/1024   |
| æœ¬ç•ª         | t3.mediumä»¥ä¸Š      | 2/20          | 1024/2048  |

### ğŸš€ CI/CDçµ±åˆ

```yaml
# GitHub Actionsä¾‹
name: Infrastructure Deploy
on:
  push:
    branches: [main]
    paths: ['terraform/**']

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Configure AWS credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
          aws-region: ap-northeast-1

      - name: Setup Terraform
        uses: hashicorp/setup-terraform@v2
        with:
          terraform_version: ">= 1.0"

      - name: Terraform Plan
        run: |
          cd terraform
          terraform init
          terraform plan -out=tfplan

      - name: Terraform Apply
        run: |
          cd terraform
          terraform apply tfplan
```

## ğŸ”— é–¢é€£ãƒªãƒ³ã‚¯

- [Terraformå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://www.terraform.io/docs/)
- [AWS Providerå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)
- [AWS Well-Architected Framework](https://aws.amazon.com/architecture/well-architected/)
- [Terraform Best Practices](https://www.terraform-best-practices.com/)

## ğŸ“ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯[MIT License](LICENSE)ã®ä¸‹ã§æä¾›ã•ã‚Œã¦ã„ã¾ã™ã€‚

## ğŸ¤ ã‚³ãƒ³ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³

ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚„ã‚¤ã‚·ãƒ¥ãƒ¼ã®ä½œæˆã‚’æ­“è¿ã—ã¾ã™ã€‚è©³ç´°ã¯[CONTRIBUTING.md](CONTRIBUTING.md)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

---

**æœ€çµ‚æ›´æ–°**: 2024å¹´12æœˆ
**å‹•ä½œç¢ºèª**: Terraform 1.0+, AWS Provider 5.x
**ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹**: ç¶™ç¶šçš„ãªæ›´æ–°ãƒ»æ”¹å–„ã‚’å®Ÿæ–½
